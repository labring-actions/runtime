FROM scratch
MAINTAINER sealos
LABEL init="init.sh" \
      init-cri="init-cri.sh" \
      clean="clean.sh" \
      clean-cri="clean-cri.sh" \
      check="check.sh \$registryData" \
      init-registry="init-registry.sh \$registryData \$registryConfig" \
      clean-registry="clean-registry.sh \$registryData \$registryConfig" \
      vip="\$defaultVIP" \
      sealos.io.type=rootfs \
      sealos.io.version=v1beta1 \
      sealos.io.distribution=k3s \
      version=v1.27.4 \
      sandboxImage="\$sandboxImage" \
      imageCRIEndpoint="\$SEALOS_SYS_IMAGE_ENDPOINT"
ENV registryData=/var/lib/registry \
    registryConfig=/etc/registry \
    registryDomain=sealos.hub \
    registryPort=5000 \
    registryUsername=admin \
    registryPassword=passw0rd \
    defaultVIP=10.103.97.2 \
    SEALOS_SYS_CRI_ENDPOINT=/run/k3s/containerd/containerd.sock \
    SEALOS_SYS_IMAGE_ENDPOINT=/var/run/image-cri-shim.sock \
    sandboxImage=rancher/mirrored-pause:3.6
COPY --from=docker.io/labring/kubernetes:v1.25.13  cri/registry cri/registry
COPY --from=ghcr.io/labring/sealos-patch:latest  . .
COPY . .
